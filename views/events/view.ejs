<%- include('../partials/header') %> <%- include('../partials/navbar') %>

<div class="container my-5">
  <div class="card shadow-lg">
    <% if (event.imageUrls && event.imageUrls.length > 0) { %>
    <!-- Bootstrap Carousel for multiple images -->
    <div id="eventMediaCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">
        <% event.imageUrls.forEach((url, index) => { %>
        <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
          <img
            src="<%= url %>"
            class="d-block w-100"
            alt="Event Image"
            style="max-height: 400px; object-fit: cover"
          />
        </div>
        <% }) %>
      </div>
      <% if (event.imageUrls.length > 1) { %>
      <button
        class="carousel-control-prev"
        type="button"
        data-bs-target="#eventMediaCarousel"
        data-bs-slide="prev"
      >
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button
        class="carousel-control-next"
        type="button"
        data-bs-target="#eventMediaCarousel"
        data-bs-slide="next"
      >
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
      <% } %>
    </div>
    <% } else { %>
    <img
      src="/default-image.jpg"
      class="card-img-top"
      alt="No Media Available"
      style="max-height: 400px; object-fit: cover"
    />
    <% } %>

    <div class="card-body">
      <h2 class="card-title text-success"><%= event.title %></h2>
      <p class="text-muted">
        <strong>Date:</strong> <%= new Date(event.date).toDateString() %>
      </p>
      <p class="card-text fs-5" style="white-space: pre-wrap">
        <%= event.description %>
      </p>

      <% if (event.videoUrl) { const videoExt =
      event.videoUrl.split('.').pop().toLowerCase(); %>
      <div class="mt-4">
        <h5>Video</h5>
        <div style="width: 100%; max-width: 800px; margin: auto">
          <video class="w-100" controls style="height: auto; display: block">
            <source src="<%= event.videoUrl %>" type="video/<%= videoExt %>" />
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
      <% } %> 
      
      <% if (event.audioUrl) { const audioExt =
      event.audioUrl.split('.').pop().toLowerCase(); %>
      <div class="mt-4">
        <h5>Audio</h5>
        <audio class="w-100" controls>
          <source src="<%= event.audioUrl %>" type="audio/<%= audioExt %>" />
          Your browser does not support the audio element.
        </audio>
      </div>
      <% } %>
    </div>
  </div>

  <div class="mt-4">
    <a href="/events" class="btn btn-outline-primary">‚Üê Back to Events</a>
  </div>
</div>

<%- include('../partials/footer') %>
