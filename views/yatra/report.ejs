<%- include('../partials/header') %>
<%- include('../partials/navbar') %>

<div class="container mt-4">
  <h3 class="text-center text-danger">ЁЯМ╕ Vrindavan Yatra Registration Report ЁЯМ╕</h3>

  <!-- тЬЕ Summary Section -->
  <!-- ЁЯФе Stylish Summary Section -->
<div class="row text-center mb-4">
  <div class="col-md-3 col-6 mb-3">
    <div class="p-3 bg-success text-white rounded shadow">
      <div class="fs-4 fw-bold">тЬЕ Register</div>
      <div class="display-6"><%= summary.totalBooked %></div>
    </div>
  </div>
  <div class="col-md-3 col-6 mb-3">
    <div class="p-3 bg-warning text-dark rounded shadow">
      <div class="fs-4 fw-bold">ЁЯкС Left</div>
      <div class="display-6"><%= summary.seatsLeft %></div>
    </div>
  </div>
  <div class="col-md-3 col-6 mb-3">
    <div class="p-3 bg-primary text-white rounded shadow">
      <div class="fs-4 fw-bold">ЁЯСи Male</div>
      <div class="display-6"><%= summary.maleCount %></div>
    </div>
  </div>
  <div class="col-md-3 col-6 mb-3">
    <div class="p-3 bg-danger text-white rounded shadow">
      <div class="fs-4 fw-bold">ЁЯСй Female</div>
      <div class="display-6"><%= summary.femaleCount %></div>
    </div>
  </div>
  <div class="col-md-3 col-6 mb-3">
    <div class="p-3 bg-info text-white rounded shadow">
      <div class="fs-4 fw-bold">ЁЯЪЖ 3AC</div>
      <div class="display-6"><%= summary.ac3Count %></div>
    </div>
  </div>
  <div class="col-md-3 col-6 mb-3">
    <div class="p-3 bg-secondary text-white rounded shadow">
      <div class="fs-4 fw-bold">ЁЯЫПя╕П Sleeper</div>
      <div class="display-6"><%= summary.sleeperCount %></div>
    </div>
  </div>
</div>


  <!-- ЁЯФ╜ Table -->
  <div class="text-end mb-3">
    <a href="/vrindavan-trip/report/pdf" class="btn btn-danger">ЁЯУД Export PDF</a>
    <a href="/vrindavan-trip/report/excel" class="btn btn-success">ЁЯУК Export Excel</a>
  </div>

  <table class="table table-bordered table-striped">
    <thead class="table-danger text-center">
      <tr>
        <th>S.No</th>
        <th>Name</th>
        <th>Mobile</th>
        <th>Gender</th>
        <th>Age</th>
        <th>Seat Type</th>
        <th>Registered At</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody>
      <% yatraList.forEach((y, index) => { %>
        <tr>
          <td><%= index + 1 %></td>
          <td><%= y.name %></td>
          <td><%= y.mobile %></td>
          <td><%= y.gender %></td>
          <td><%= y.dob ? moment().diff(moment(y.dob), 'years') : '' %></td>
          <td><%= y.seatType || '-' %></td>
          <td><%= moment(y.registeredAt).utcOffset(330).format('DD-MM-YYYY HH:mm') %></td>
          <td>
            <button class="btn btn-sm btn-outline-danger" onclick="confirmDelete('<%= y._id %>')">ЁЯЧСя╕П Delete</button>
          </td>

        </tr>
      <% }) %>
    </tbody>
  </table>

  <!-- ЁЯУЭ Instructions Placeholder -->
  <div class="alert alert-warning mt-5">
    <h5>ЁЯУЭ Instructions:</h5>
    <ol>
  <li>рдпрд╣ рдпрд╛рддреНрд░рд╛ рдЯреНрд░реЗрди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреА рдЬрд╛рдПрдЧреА тАФ рдХреЛрдЪ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ 3AC (рдПрд╕реА) рдФрд░ рд╕реНрд▓реАрдкрд░ (рдиреЙрди-рдПрд╕реА) рдореЗрдВ рд╣реИред</li>
  <li>3AC рдпрд╛рддреНрд░рд╛ рдХрд╛ рдЕрдиреБрдорд╛рдирд┐рдд рдЦрд░реНрдЪ тВ╣3,500 рд╕реЗ тВ╣4,000 рддрдХ рд░рд╣реЗрдЧрд╛ред</li>
  <li>рд╕реНрд▓реАрдкрд░ (рдиреЙрди-рдПрд╕реА) рдХрд╛ рдЕрдиреБрдорд╛рдирд┐рдд рдЦрд░реНрдЪ рд▓рдЧрднрдЧ тВ╣2,500 рд░рд╣реЗрдЧрд╛ред</li>
  <li>рдпрд╣ рдХреЛрдИ рдЯреВрд░ рдкреИрдХреЗрдЬ рдирд╣реАрдВ рд╣реИред</li>
  <li>рд╣рдо рдПрдХ рд╕рдореВрд╣ рдХреЗ рд░реВрдк рдореЗрдВ рдорд┐рд▓рдХрд░ рдпрд╛рддреНрд░рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ тАФ рдпрд╣ рдПрдХ рд╕рд╣рднрд╛рдЧреА рдпрд╛рддреНрд░рд╛ рд╣реИред</li>
  <li>рд╣рдорд╛рд░реА рдЬрд┐рдореНрдореЗрджрд╛рд░реА рдХреЗрд╡рд▓ рдЯреНрд░реЗрди рдЯрд┐рдХрдЯ рдФрд░ рдордереБрд░рд╛ рд╕реЗ рд╡реГрдВрджрд╛рд╡рди рддрдерд╛ рд╡рд╛рдкрд╕реА рдХреЗ рд▓рд┐рдП рдмрд╕ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рддрдХ рд╕реАрдорд┐рдд рд╣реИред</li>
  <li>рднреЛрдЬрди, рдСрдЯреЛ рдпрд╛ рдЕрдиреНрдп рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЦрд░реНрдЪреЛрдВ рдХреА рдЬрд┐рдореНрдореЗрджрд╛рд░реА рдпрд╛рддреНрд░рд┐рдпреЛрдВ рдХреА рд╕реНрд╡рдпрдВ рдХреА рд╣реЛрдЧреАред</li>
  <li>рдкрдВрдЬреАрдХрд░рдг 30 рдЕрдЧрд╕реНрдд рддрдХ рдпрд╛ рдЕрдзрд┐рдХрддрдо 60 рдпрд╛рддреНрд░рд┐рдпреЛрдВ рдХреЗ рдкреВрд░рд╛ рд╣реЛрддреЗ рд╣реА рдмрдВрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</li>
  <li>рдЖрд╢реНрд░рдо рдореЗрдВ 13 рдПрд╕реА рдХрдорд░реЗ (рдкреНрд░рддрд┐ рдХрдорд░рд╛ 3 рд╡реНрдпрдХреНрддрд┐) рдФрд░ рдПрдХ рдмрдбрд╝рд╛ рд╣реЙрд▓ (20тАУ25 рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП) рдЙрдкрд▓рдмреНрдз рд╣реИред</li>
  <li>рд╣рдо рдЖрд╢реНрд░рдо рд╕реЗ 2 рдирд╛рд╢реНрддреЗ рдФрд░ рд░рд╛рдд рдХреЗ рднреЛрдЬрди рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рдкрд░ рдмрд╛рддрдЪреАрдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ тАФ рдЦрд░реНрдЪ рд╕рд╛рдЭрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</li>
  <li>рдХрдорд░реЗ рдпрд╛ рд╣реЙрд▓ рдореЗрдВ рд░рд╣рдиреЗ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд░рд╛рд╢рд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреА рдЬрд╛рдПрдЧреАред</li>
  <li>рдпрд╣ рдПрдХ рдпреЛрдЧрд┐рдХ рдПрд╡рдВ рдЖрдзреНрдпрд╛рддреНрдорд┐рдХ рдпрд╛рддреНрд░рд╛ рд╣реИ тАФ рд╕рдордп рдорд┐рд▓рдиреЗ рдкрд░ рдзреНрдпрд╛рди, рдпреЛрдЧрдирд┐рджреНрд░рд╛ рдпрд╛ рдпреЛрдЧ рд╕рддреНрд░ рдЖрдпреЛрдЬрд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред</li>
  <li>рдХрд┐рд╕реА рднреА рдкреНрд░рд╢реНрди рдпрд╛ рд╕рд╣рд╛рдпрддрд╛ рд╣реЗрддреБ рдХреГрдкрдпрд╛ рд╣рдорд╛рд░реА рдЯреАрдо рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдВред</li>
</ol>

  </div>
</div>

<script>
  function confirmDelete(id) {
    if (!confirm("Are you sure you want to delete this record?")) return;

    // Show spinner
    const spinner = document.getElementById('loadingSpinner');
    if (spinner) spinner.style.display = 'block';

    fetch(`/vrindavan-trip/delete/${id}`, {
      method: 'DELETE',
    })
    .then(res => res.json())
    .then(data => {
      if (spinner) spinner.style.display = 'none';
      if (data.success) {
        alert('тЬЕ Deleted successfully');
        location.reload();
      } else {
        alert('тЭМ Delete failed');
      }
    })
    .catch(err => {
      if (spinner) spinner.style.display = 'none';
      alert('тЭМ Error deleting record');
    });
  }
</script>


<%- include('../partials/footer') %>
